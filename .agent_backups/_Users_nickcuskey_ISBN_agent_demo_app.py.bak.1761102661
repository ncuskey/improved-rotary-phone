from flask import Flask, request, jsonify

app = Flask(__name__)

def get_score(text):
    """Calculates the score for a given text, which is its length."""
    return len(text)

def get_probability(score):
    """
    Calculates the probability based on a score, mimicking the iOS app's logic.
    """
    if score > 10:
        return 1.0
    elif score > 5:
        return 0.75
    elif score > 3:
        return 0.5
    elif score > 0:
        return 0.25
    else:
        return 0.0

@app.route('/score', methods=['POST'])
def score_endpoint():
    """Endpoint to receive text and return its score and probability."""
    data = request.get_json()
    if not data or 'text' not in data:
        return jsonify({'error': 'Missing text in request body'}), 400
    
    text = data['text']
    score = get_score(text)
    probability = get_probability(score)
    
    return jsonify({
        'text': text,
        'score': score,
        'probability': probability
    })

if __name__ == '__main__':
    app.run(host='0.0.0.0', port=5001, debug=False)